(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{24:function(e,t){},27:function(e,t,n){e.exports=n(72)},32:function(e,t,n){},59:function(e,t,n){},61:function(e,t,n){e.exports=n.p+"static/media/logo-white.1f8e9a89.svg"},62:function(e,t,n){},64:function(e,t,n){e.exports=n.p+"static/media/logo.5e21847f.svg"},65:function(e,t,n){},70:function(e,t,n){},72:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(23),i=n.n(o),s=(n(32),n(5)),c=n(7),u=n(10),l=n(8),d=n(11),h=n(74),m=n(75),p=n(24),f=(n.n(p).a,n(25)),g=n.n(f),v=n(15),E=n.n(v),O=n(19),b="https://api.lace.guide",y="afjCEsnkK3bJ@#$dz%3JRTMtWJIAZs@Cc$Me*%!KkXpNR9G1MS$2xtfn5!FfGsy!caK5#kVd4l%ghDyFWp2jAVGaPYdAaerCDW9Snu0G#IOXVBIb*uCx5gt7O0&c1&tUg#G7Nd5nUHTQM7d32nzRlRa3D&WqWN9y&Bqe3SCv7C*mS4LFV5kM37wFbgDgvjELZI%mvx*v&a!w0Ie3XWy$Gdu6NJJUJ#eN^&Q!pCUVyWkZ9B7py8p^a*92r80iOrX3v@BSREqS^MEkx3$#2kUtP%#X5Oq!L*Ovg9Fg5$6xR0oX",w=function(e){return console.log(e),fetch("".concat(b,"/auth/connectUser"),{method:"POST",headers:{"Content-Type":"application/json",auth:y},body:JSON.stringify(e)}).then(function(){var e=Object(O.a)(E.a.mark(function e(t){var n;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.json();case 2:return n=e.sent,console.log(n),e.abrupt("return",n);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()).catch(function(e){console.log(e)})},D=(n(59),n(61)),I=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).renderLoginButton=function(){return r.a.createElement("button",{className:"login-button",onClick:function(){w({username:n.state.username,password:g.a.SHA3(n.state.password).toString()}).then(function(e){e&&(localStorage.setItem("@User",JSON.stringify(e)),"stream"===n.props.history.location.state?n.props.history.push("/streamer"):n.props.history.push("/player"))})}},"Connect")},n.state={username:void 0,password:void 0},console.log(n.props.history),n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"auth-container"},r.a.createElement("img",{className:"brand-logo",alt:"lace",src:D}),r.a.createElement("input",{className:"auth-input",placeholder:"username",value:this.state.username,onChange:function(t){e.setState({username:t.target.value})}}),r.a.createElement("input",{className:"auth-input",placeholder:"password",type:"password",value:this.state.password,onChange:function(t){e.setState({password:t.target.value})}}),this.renderLoginButton())}}]),t}(a.PureComponent),S=function e(t){var n=this;Object(s.a)(this,e),this.startObjectDetection=function(e){var t=e.createElement("canvas");t.width=n.UPLOAD_WITH,t.height=n.UPLOAD_WITH*(n.VIDOE_REF.videoHeight/n.VIDOE_REF.videoWidth),t.getContext("2d").drawImage(n.VIDOE_REF,0,0,n.VIDOE_REF.videoWidth,n.VIDOE_REF.videoHeight,0,0,n.UPLOAD_WITH,n.UPLOAD_WITH*(n.VIDOE_REF.videoHeight/n.VIDOE_REF.videoWidth)),t.toBlob(function(e){!function(e,t,n){var a={image:e,treshold:t||.5};console.log(a),console.log(a.image),console.log(JSON.stringify(a)),fetch("".concat(b,"/stream/streamAndDetect"),{method:"POST",headers:{"Content-Type":"application/json",auth:y},body:JSON.stringify(a)}).then(function(){var e=Object(O.a)(E.a.mark(function e(t){var n;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.json();case 2:return n=e.sent,console.log(n),e.abrupt("return",n);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()).catch(function(e){console.log(e)})}(e,null)},"image/jpeg")},this.drawBoundingBoxes=function(e,t){var a=e.createElement("canvas");e.body.appendChild(a);var r=a.getContext("2d");r.clearRect(0,0,a.width,a.height),r.lineWidth="4",r.strokeStyle="yellow",r.font="12px sans-serif",r.fillStyle="yellow",t.filter(function(e){return e.class_name}).forEach(function(e){var t=e.x*a.width,o=e.y*a.height,i=e.width*a.width-t,s=e.height*a.height-o;n.MIRROR&&(t=a.width-(t+i)),r.fillText("".concat(e.class_name," - ").concat(Math.round(100*e.score,1),"%"),t+5,o+20),r.strokeRect(t,o,i,s)})},t?(this.VIDOE_REF=t.videoRef,this.DATA_SOURCE=t.dataSource,this.UPLOAD_WITH=t.dataUploadWidth||640,this.MIRROR=t.mirror||!1,this.THRESHOLD=t.scoreThreshold||.5):new Error("Missing video object")},j=(n(62),n(64)),C=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).init=function(){var e=!(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia),t=!1,a=!1;e?(n.OBJ_DETECT=new S({videoRef:n.VIDEO,dataMirror:!1,dataUploadWidth:1280,dataThreshold:.5}),n.VIDEO.addEventListener("playing",function(){t=!0,a&&n.OBJ_DETECT.startObjectDetection(document)}),n.VIDEO.addEventListener("loadedmetadata",function(){a=!0,t&&n.OBJ_DETECT.startObjectDetection(document)}),navigator.mediaDevices.getUserMedia({audio:!1,video:{width:{min:640,ideal:1280,max:1920},height:{min:480,ideal:720,max:1080}}}).then(function(e){console.log(e),n.setState({support:!0,mediaStream:e})})):n.setState({support:"getUserMedia() IS NOT supported by this browser"})},n.renderCameraInput=function(){return n.state.support&&n.state.mediaStream&&(n.VIDEO.srcObject=n.state.mediaStream),r.a.createElement("h1",null,n.state.support)},n.renderInitialContainer=function(){return r.a.createElement("div",{className:"initial-container"},r.a.createElement("img",{className:"brand-logo",alt:"lace",src:j}),r.a.createElement("button",{className:"stream-button",onClick:function(){n.setState({started:!0},function(){n.init()})}},"Start Streaming"))},n.renderStreamContainer=function(){return r.a.createElement("div",{className:"stream-container"},n.renderCameraInput(),r.a.createElement("video",{ref:function(e){return n.VIDEO=e},className:"video",id:"video",muted:!0,playsInline:!0,autoPlay:!0}))},n.state={started:!1,support:null,mediaStream:null},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){localStorage.getItem("@User")||this.props.history.push("/auth","stream")}},{key:"render",value:function(){return r.a.createElement("div",{className:"main-container"},this.state.started?this.renderStreamContainer():this.renderInitialContainer())}}]),t}(a.Component),B=(n(65),function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).renderBoundingBoxesButton=function(){return r.a.createElement("button",{className:"control-button ".concat(n.state.drawingBoxes?"active":""),onClick:function(){n.setState({drawingBoxes:!0},function(){n.OBJ_DETECT.drawBoundingBoxes(document)})}},"Bounding Boxes")},n.renderPlayerContainer=function(){return r.a.createElement("div",{className:"player-container"},r.a.createElement("div",{className:"video-container"},r.a.createElement("video",{ref:function(e){return n.VIDEO=e},className:"fullscreen-video",id:"video",muted:!0,playsInline:!0,autoPlay:!0})),r.a.createElement("div",{className:"button-container"},n.renderBoundingBoxesButton()))},n.state={user:localStorage.getItem("@User")},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){console.log(this.state.user),this.state.user?this.OBJ_DETECT=new S:this.props.history.push("/auth")}},{key:"render",value:function(){return r.a.createElement("div",{className:"main-container"})}}]),t}(a.Component)),N=function(){return r.a.createElement(h.a,null,r.a.createElement("div",null,r.a.createElement(m.a,{path:"/auth",component:I}),r.a.createElement(m.a,{path:"/streamer",component:C}),r.a.createElement(m.a,{path:"/player",component:B})))},T=(n(70),function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement(N,null)}}]),t}(a.PureComponent));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(T,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[27,2,1]]]);
//# sourceMappingURL=main.f2ed9725.chunk.js.map